"0","library(""ggplot2"")"
"0","theme_set(theme_bw())"
"0","scale_fill_discrete <- function(palname = ""Set1"", ...) {"
"0","    scale_fill_brewer(palette = palname, ...)"
"0","}"
"0","# remove records with NA at Genus"
"0","sigtabgen_saliva_BC = subset(bp_saliva_BC_sigtab, !is.na(Genus))"
"0","# Phylum order"
"0","x = tapply(sigtabgen_saliva_BC$log2FoldChange, sigtabgen_saliva_BC$Phylum, function(x) max(x))"
"0","x = sort(x, TRUE)"
"0","sigtabgen_saliva_BC$Phylum = factor(as.character(sigtabgen_saliva_BC$Phylum), levels=names(x))"
"0","# Genus order"
"0","x = tapply(sigtabgen_saliva_BC$log2FoldChange, sigtabgen_saliva_BC$Genus, function(x) max(x))"
"0","x = sort(x, TRUE)"
"0","sigtabgen_saliva_BC$Genus = factor(as.character(sigtabgen_saliva_BC$Genus), levels=names(x))"
"0","# Plot"
"0","bp_diff_abund_saliva_BC_plot <- ggplot(sigtabgen_saliva_BC, aes(x=Genus, y=log2FoldChange, color=Phylum)) + "
"0","  geom_point(size=2) +"
"0","  theme(axis.text.x = element_text(angle = 45,"
"0","                                   hjust = 1.05,"
"0","                                   vjust=1.05,"
"0","                                   size = 10,"
"0","                                   face = ""bold""),"
"0","        axis.title.x = element_text(size = 14, face = ""bold""),"
"0","        axis.text.y = element_text(size = 10, face = ""bold""),"
"0","        axis.title.y = element_text(size = 14, face = ""bold""),"
"0","        plot.title = element_text(size = 18, face = ""bold""),"
"0","        legend.title = element_text(size = 14, face = ""bold""),"
"0","        legend.text = element_text(size = 12, face = ""bold"")) +"
"0","  labs(title = ""Differentially Abundant Taxa of the Saliva Microbiome: Product B vs. Product C"") +"
"0","  labs(y = ""log2 Fold Change (Wald Test, Parametric Fit, alpha = 0.01)"") + "
"0","  geom_label_repel(label = sigtabgen_saliva_BC$Species2, show.legend = FALSE)"
"0","bp_diff_abund_saliva_BC_plot"
