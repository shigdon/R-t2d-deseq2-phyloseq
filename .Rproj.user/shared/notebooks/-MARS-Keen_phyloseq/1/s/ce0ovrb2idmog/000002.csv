"0","# normalize the count data"
"0","bp_norm_bcw <- transform_sample_counts(bracken_physeq, function(x) (x/sum(x))/sum(x) * 1E6)"
"0","# create matrices for otu table and taxonomy table"
"0","bp_norm_bcw_otu_table <- as(otu_table(bp_norm_bcw), ""matrix"")"
"0","bp_norm_bcw_taxa_table <- as(tax_table(bp_norm_bcw), ""matrix"")"
"0","# convert matrices to data.frame"
"0","bp_norm_bcw_otu_table_df <- as.data.frame(bp_norm_bcw_otu_table)"
"0","bp_norm_bcw_taxa_table_df <- as.data.frame(bp_norm_bcw_taxa_table)"
"0","# inspect elements"
"0","#head(bp_norm_bcw_otu_table_df)"
"0","#head(bp_norm_bcw_taxa_table_df)"
"0","# mutate otu table to add Taxonomy ID variable"
"0","bp_norm_bcw_otu_table_df <- mutate(bp_norm_bcw_otu_table_df, OTU= rownames(bp_norm_bcw_otu_table_df))"
"0","# Merge OTU and Taxonomy dataframes by OTU variable"
"0","bp_bcw_norm_master_df <- inner_join(bp_norm_bcw_otu_table_df,"
"0","                                    bp_norm_bcw_taxa_table_df,"
"0","                                    by = ""OTU"")"
"2","Column `OTU` joining character vector and factor, coercing into character vector"
"0","# Inspect non sample variable names"
"0","colnames(bp_bcw_norm_master_df[153:161])"
"1","[1]"
"1"," ""OTU""     "
"1"," ""Kingdom"" "
"1"," ""Phylum""  "
"1"," ""Class""   "
"1"," ""Order""   "
"1"," ""Family""  "
"1"," ""Genus""   "
"1"," ""Species"" "
"1"," ""Species2"""
"1","
"
"0","# clone for rownames as taxa names"
"0","bp_bcw_norm_master_df2 <- bp_bcw_norm_master_df"
"0","# set rownames to full taxonomic id (genus + species + OTU tax_id)"
"0","rownames(bp_bcw_norm_master_df2) <- bp_bcw_norm_master_df$Species2"
"0","# subset dataframe to grab only sample abundance data"
"0","bp_bcw_norm_abund_df <- bp_bcw_norm_master_df2[,1:152]"
"0","# save normalized OTU abundance matrix"
"0","write.csv(bp_bcw_norm_abund_df, ""./R_output_files/bracken_bcw-normalized-relabund_tax-names.csv"")"
