"0","# read in hdf5 biom table from kraken-biom output of bracken reports"
"0","bracken_biom_file <- read_hdf5_biom(""./MARS-Keen_bracken_biom_table-seqids.hdf5"")"
"0","# create biom object"
"0","bracken_biom <- biom(bracken_biom_file)"
"0","bracken_physeq <- import_biom(bracken_biom, parseFunction = parse_taxonomy_greengenes)"
"0","# summary of bracken biom"
"0","bracken_physeq"
"1","phyloseq-class experiment-level object"
"1","
"
"1","otu_table()   OTU Table:         [ 7166 taxa and 153 samples ]"
"1","
"
"1","tax_table()   Taxonomy Table:    [ 7166 taxa by 7 taxonomic ranks ]"
"1","
"
"0","head(tax_table(bracken_physeq))"
"1","Taxonomy Table:     [6 taxa by 7 taxonomic ranks]:"
"1","
"
"1","      "
"1"," Kingdom   "
"1"," Phylum         "
"1"," Class        "
"1"," Order          "
"1"," Family          "
"1"," Genus        "
"1","
821   "
"1"," ""Bacteria"""
"1"," ""Bacteroidetes"""
"1"," ""Bacteroidia"""
"1"," ""Bacteroidales"""
"1"," ""Bacteroidaceae"""
"1"," ""Bacteroides"""
"1","
290053"
"1"," ""Bacteria"""
"1"," ""Bacteroidetes"""
"1"," ""Bacteroidia"""
"1"," ""Bacteroidales"""
"1"," ""Bacteroidaceae"""
"1"," ""Bacteroides"""
"1","
28116 "
"1"," ""Bacteria"""
"1"," ""Bacteroidetes"""
"1"," ""Bacteroidia"""
"1"," ""Bacteroidales"""
"1"," ""Bacteroidaceae"""
"1"," ""Bacteroides"""
"1","
817   "
"1"," ""Bacteria"""
"1"," ""Bacteroidetes"""
"1"," ""Bacteroidia"""
"1"," ""Bacteroidales"""
"1"," ""Bacteroidaceae"""
"1"," ""Bacteroides"""
"1","
246787"
"1"," ""Bacteria"""
"1"," ""Bacteroidetes"""
"1"," ""Bacteroidia"""
"1"," ""Bacteroidales"""
"1"," ""Bacteroidaceae"""
"1"," ""Bacteroides"""
"1","
357276"
"1"," ""Bacteria"""
"1"," ""Bacteroidetes"""
"1"," ""Bacteroidia"""
"1"," ""Bacteroidales"""
"1"," ""Bacteroidaceae"""
"1"," ""Bacteroides"""
"1","
"
"1","      "
"1"," Species           "
"1","
821   "
"1"," ""vulgatus""        "
"1","
290053"
"1"," ""helcogenes""      "
"1","
28116 "
"1"," ""ovatus""          "
"1","
817   "
"1"," ""fragilis""        "
"1","
246787"
"1"," ""cellulosilyticus"""
"1","
357276"
"1"," ""dorei""           "
"1","
"
"0","# Read in the sample map file (list has strictly static order, numeric ascending)"
"0","sample_map <- read.csv(""./../meta_files/MARS-Keen_metadata.csv"", header = T, row.names = 1)"
"0","# create phyloseq sample map from dataframe"
"0","bracken_sam <- sample_data(sample_map, errorIfNULL = TRUE)"
"0","bracken_physeq <- merge_phyloseq(bracken_physeq, bracken_sam)"
"0","# add tax rank Species2"
"0","tax_table(bracken_physeq) <- cbind(tax_table(bracken_physeq), OTU=taxa_names(bracken_physeq))"
"0","## Define Ranks to include"
"0","label_ranks <- c(""Genus"", ""Species"", ""OTU"")"
"0","labels <- apply(tax_table(bracken_physeq)[, label_ranks], 1, paste, sep="""", collapse="" "")"
"0","## add concatenated labels as a new rank after Species2"
"0","tax_table(bracken_physeq) <- cbind(tax_table(bracken_physeq), Species2=labels)"
"0","head(tax_table(bracken_physeq))"
"1","Taxonomy Table:     [6 taxa by 9 taxonomic ranks]:"
"1","
"
"1","      "
"1"," Kingdom   "
"1"," Phylum         "
"1"," Class        "
"1"," Order          "
"1"," Family          "
"1"," Genus        "
"1","
821   "
"1"," ""Bacteria"""
"1"," ""Bacteroidetes"""
"1"," ""Bacteroidia"""
"1"," ""Bacteroidales"""
"1"," ""Bacteroidaceae"""
"1"," ""Bacteroides"""
"1","
290053"
"1"," ""Bacteria"""
"1"," ""Bacteroidetes"""
"1"," ""Bacteroidia"""
"1"," ""Bacteroidales"""
"1"," ""Bacteroidaceae"""
"1"," ""Bacteroides"""
"1","
28116 "
"1"," ""Bacteria"""
"1"," ""Bacteroidetes"""
"1"," ""Bacteroidia"""
"1"," ""Bacteroidales"""
"1"," ""Bacteroidaceae"""
"1"," ""Bacteroides"""
"1","
817   "
"1"," ""Bacteria"""
"1"," ""Bacteroidetes"""
"1"," ""Bacteroidia"""
"1"," ""Bacteroidales"""
"1"," ""Bacteroidaceae"""
"1"," ""Bacteroides"""
"1","
246787"
"1"," ""Bacteria"""
"1"," ""Bacteroidetes"""
"1"," ""Bacteroidia"""
"1"," ""Bacteroidales"""
"1"," ""Bacteroidaceae"""
"1"," ""Bacteroides"""
"1","
357276"
"1"," ""Bacteria"""
"1"," ""Bacteroidetes"""
"1"," ""Bacteroidia"""
"1"," ""Bacteroidales"""
"1"," ""Bacteroidaceae"""
"1"," ""Bacteroides"""
"1","
"
"1","      "
"1"," Species           "
"1"," OTU     "
"1"," Species2                             "
"1","
821   "
"1"," ""vulgatus""        "
"1"," ""821""   "
"1"," ""Bacteroides vulgatus 821""           "
"1","
290053"
"1"," ""helcogenes""      "
"1"," ""290053"""
"1"," ""Bacteroides helcogenes 290053""      "
"1","
28116 "
"1"," ""ovatus""          "
"1"," ""28116"" "
"1"," ""Bacteroides ovatus 28116""           "
"1","
817   "
"1"," ""fragilis""        "
"1"," ""817""   "
"1"," ""Bacteroides fragilis 817""           "
"1","
246787"
"1"," ""cellulosilyticus"""
"1"," ""246787"""
"1"," ""Bacteroides cellulosilyticus 246787"""
"1","
357276"
"1"," ""dorei""           "
"1"," ""357276"""
"1"," ""Bacteroides dorei 357276""           "
"1","
"
"0","ntaxa(bracken_physeq)"
"1","[1]"
"1"," 7166"
"1","
"
"0","nsamples(bracken_physeq)"
"1","[1]"
"1"," 152"
"1","
"
"0","sample_names(bracken_physeq)"
"1","  [1]"
"1"," ""ST001"""
"1"," ""ST002"""
"1"," ""ST003"""
"1"," ""ST004"""
"1"," ""ST005"""
"1"," ""ST006"""
"1"," ""ST007"""
"1"," ""ST008"""
"1"," ""ST009"""
"1"," ""ST010"""
"1"," ""ST011"""
"1"," ""ST012"""
"1"," ""ST013"""
"1","
"
"1"," [14]"
"1"," ""ST014"""
"1"," ""ST015"""
"1"," ""ST016"""
"1"," ""ST017"""
"1"," ""ST018"""
"1"," ""ST019"""
"1"," ""ST020"""
"1"," ""ST021"""
"1"," ""ST022"""
"1"," ""ST023"""
"1"," ""ST024"""
"1"," ""ST025"""
"1"," ""ST026"""
"1","
"
"1"," [27]"
"1"," ""ST027"""
"1"," ""ST028"""
"1"," ""ST029"""
"1"," ""ST030"""
"1"," ""ST031"""
"1"," ""ST032"""
"1"," ""ST033"""
"1"," ""ST034"""
"1"," ""ST035"""
"1"," ""ST036"""
"1"," ""ST037"""
"1"," ""ST038"""
"1"," ""ST040"""
"1","
"
"1"," [40]"
"1"," ""ST041"""
"1"," ""ST042"""
"1"," ""ST043"""
"1"," ""ST044"""
"1"," ""ST045"""
"1"," ""ST046"""
"1"," ""ST047"""
"1"," ""ST048"""
"1"," ""ST049"""
"1"," ""ST051"""
"1"," ""ST052"""
"1"," ""ST053"""
"1"," ""ST054"""
"1","
"
"1"," [53]"
"1"," ""ST056"""
"1"," ""ST057"""
"1"," ""ST058"""
"1"," ""ST059"""
"1"," ""ST060"""
"1"," ""ST061"""
"1"," ""ST062"""
"1"," ""ST063"""
"1"," ""ST064"""
"1"," ""ST065"""
"1"," ""ST066"""
"1"," ""ST067"""
"1"," ""ST070"""
"1","
"
"1"," [66]"
"1"," ""ST071"""
"1"," ""ST072"""
"1"," ""ST073"""
"1"," ""ST075"""
"1"," ""ST076"""
"1"," ""ST077"""
"1"," ""ST078"""
"1"," ""ST079"""
"1"," ""ST080"""
"1"," ""ST081"""
"1"," ""ST082"""
"1"," ""ST083"""
"1"," ""ST084"""
"1","
"
"1"," [79]"
"1"," ""ST085"""
"1"," ""ST086"""
"1"," ""ST087"""
"1"," ""ST088"""
"1"," ""ST089"""
"1"," ""ST090"""
"1"," ""ST091"""
"1"," ""ST092"""
"1"," ""ST093"""
"1"," ""ST094"""
"1"," ""ST095"""
"1"," ""ST096"""
"1"," ""ST097"""
"1","
"
"1"," [92]"
"1"," ""ST098"""
"1"," ""ST099"""
"1"," ""ST100"""
"1"," ""ST101"""
"1"," ""ST102"""
"1"," ""ST103"""
"1"," ""ST104"""
"1"," ""ST105"""
"1"," ""ST106"""
"1"," ""ST107"""
"1"," ""ST108"""
"1"," ""ST109"""
"1"," ""ST110"""
"1","
"
"1","[105]"
"1"," ""ST111"""
"1"," ""ST112"""
"1"," ""ST113"""
"1"," ""ST114"""
"1"," ""ST115"""
"1"," ""ST116"""
"1"," ""ST117"""
"1"," ""ST118"""
"1"," ""ST119"""
"1"," ""ST120"""
"1"," ""ST121"""
"1"," ""ST122"""
"1"," ""ST123"""
"1","
"
"1","[118]"
"1"," ""ST124"""
"1"," ""ST125"""
"1"," ""ST126"""
"1"," ""ST127"""
"1"," ""ST128"""
"1"," ""ST129"""
"1"," ""ST130"""
"1"," ""ST131"""
"1"," ""ST132"""
"1"," ""ST133"""
"1"," ""ST134"""
"1"," ""ST135"""
"1"," ""ST136"""
"1","
"
"1","[131]"
"1"," ""ST137"""
"1"," ""ST138"""
"1"," ""ST139"""
"1"," ""ST140"""
"1"," ""ST141"""
"1"," ""ST142"""
"1"," ""ST143"""
"1"," ""ST144"""
"1"," ""ST145"""
"1"," ""ST146"""
"1"," ""ST147"""
"1"," ""ST148"""
"1"," ""ST149"""
"1","
"
"1","[144]"
"1"," ""ST150"""
"1"," ""ST151"""
"1"," ""ST152"""
"1"," ""ST153"""
"1"," ""ST154"""
"1"," ""ST155"""
"1"," ""ST156"""
"1"," ""ST157"""
"1"," ""ST158"""
"1","
"
"0","rank_names(bracken_physeq)"
"1","[1]"
"1"," ""Kingdom"" "
"1"," ""Phylum""  "
"1"," ""Class""   "
"1"," ""Order""   "
"1"," ""Family""  "
"1"," ""Genus""   "
"1"," ""Species"" "
"1"," ""OTU""     "
"1"," ""Species2"""
"1","
"
"0","sample_variables(bracken_physeq)"
"1","[1]"
"1"," ""Sample_ID""       "
"1"," ""Sex""             "
"1"," ""Product""         "
"1"," ""Protein""         "
"1"," ""Fortification""   "
"1","
"
"1","[6]"
"1"," ""O_N""             "
"1"," ""Sample_Type""     "
"1"," ""Timepoint""       "
"1"," ""Humann2_Complete"""
"1","
"
