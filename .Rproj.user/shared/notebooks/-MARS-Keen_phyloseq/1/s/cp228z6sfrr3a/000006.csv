"0","# Convert master df to narrow format, Keep Taxon Name"
"0","bp_bcw_norm_abund_narrow_df <- bp_bcw_norm_master_df %>% gather(key = ""Sample"", value = ""norm_rel_abund"", -Species2)"
"2","attributes are not identical across measure variables;
they will be dropped"
"0","# Inspect Element"
"0","head(bp_bcw_norm_abund_narrow_df)"
"1"," "
"1","                            Species2"
"1"," Sample"
"1","       norm_rel_abund"
"1","
1"
"1","            Bacteroides vulgatus 821"
"1","  ST001"
"1","  0.00125072106523601"
"1","
2"
"1","       Bacteroides helcogenes 290053"
"1","  ST001"
"1"," 0.000493407832344203"
"1","
3"
"1","            Bacteroides ovatus 28116"
"1","  ST001"
"1"," 0.000414588904081989"
"1","
4"
"1","            Bacteroides fragilis 817"
"1","  ST001"
"1"," 0.000283907314023858"
"1","
5"
"1"," Bacteroides cellulosilyticus 246787"
"1","  ST001"
"1"," 0.000215370877780669"
"1","
6"
"1","            Bacteroides dorei 357276"
"1","  ST001"
"1"," 0.000115649043296733"
"1","
"
"0","# add time variable to bp_bcw_norm_master_df"
"0","bp_bcw_norm_abund_narrow_df$Timepoint <- sample_map$Timepoint[match(bp_bcw_norm_abund_narrow_df$Sample, rownames(sample_map))]"
"0","# add Patient_ID Variable"
"0","bp_bcw_norm_abund_narrow_df$Patient_ID <- sample_map$Sample_ID[match(bp_bcw_norm_abund_narrow_df$Sample, rownames(sample_map))]"
"0","# add Sample_Type Variable"
"0","bp_bcw_norm_abund_narrow_df$Sample_Type <- sample_map$Sample_Type[match(bp_bcw_norm_abund_narrow_df$Sample, rownames(sample_map))]"
"0","# subset by Sample_Type to create two dataframes"
"0","## Saliva"
"0","bp_bcw_norm_abund_narrow_saliva_df <- filter(bp_bcw_norm_abund_narrow_df, Sample_Type == ""Saliva"")"
"0","## Fecal"
"0","bp_bcw_norm_abund_narrow_fecal_df <- filter(bp_bcw_norm_abund_narrow_df, Sample_Type == ""Fecal"")"
"0","# Check that the levels of patient ID are equal between sample types"
"0","unique(bp_bcw_norm_abund_narrow_saliva_df$Patient_ID)"
"1"," [1]"
"1"," T1C018"
"1"," T1C047"
"1"," T1C048"
"1"," T1C050"
"1"," T1C054"
"1"," T1C056"
"1"," T1C057"
"1"," T1C059"
"1"," T1C063"
"1"," T1C020"
"1"," T1C021"
"1"," T1C029"
"1"," T1C031"
"1"," T1C037"
"1"," T1C044"
"1","
"
"1","[16]"
"1"," T1C060"
"1"," T1C062"
"1"," T1C073"
"1"," T1C077"
"1"," T1C022"
"1"," T1C027"
"1"," T1C032"
"1"," T1C034"
"1"," T1C036"
"1"," T1C049"
"1"," T1C064"
"1"," T1C070"
"1"," T1C076"
"1"," T1C081"
"1"," T1C023"
"1","
"
"1","[31]"
"1"," T1C030"
"1"," T1C033"
"1"," T1C046"
"1"," T1C051"
"1"," T1C053"
"1"," T1C058"
"1"," T1C061"
"1"," T1C069"
"1"," T1C071"
"1"," T1C072"
"1","
"
"1","41 "
"1","Levels: "
"1","T1C018 T1C020 T1C021 T1C022 T1C023 T1C027 T1C029 T1C030 T1C031 T1C032 T1C033 T1C034 ... T1C081"
"1","
"
"0","nlevels(bp_bcw_norm_abund_narrow_fecal_df$Patient_ID)"
"1","[1]"
"1"," 41"
"1","
"
"0","# Subset based on Timepoint"
"0","## Saliva"
"0","### Time 1 (t1)"
"0","bp_bcw_norm_abund_sal_t1 <- bp_bcw_norm_abund_narrow_saliva_df %>% filter(Timepoint == ""Initial"") %>% select(""Species2"", ""norm_rel_abund"", ""Patient_ID"")"
"0","### Time 2 (t2)"
"0","bp_bcw_norm_abund_sal_t2 <- bp_bcw_norm_abund_narrow_saliva_df %>% filter(Timepoint == ""Final"")"
"0","colnames(bp_bcw_norm_abund_sal_t1)"
"1","[1]"
"1"," ""Species2""      "
"1"," ""norm_rel_abund"""
"1"," ""Patient_ID""    "
"1","
"
"0","head(bp_bcw_norm_abund_sal_t1)"
"1"," "
"1","                            Species2"
"1","       norm_rel_abund"
"1"," Patient_ID"
"1","
1"
"1","            Bacteroides vulgatus 821"
"1"," 2.23288513267209e-05"
"1","     T1C018"
"1","
2"
"1","       Bacteroides helcogenes 290053"
"1"," 2.18095872108589e-07"
"1","     T1C018"
"1","
3"
"1","            Bacteroides ovatus 28116"
"1"," 6.91543226871412e-07"
"1","     T1C018"
"1","
4"
"1","            Bacteroides fragilis 817"
"1"," 7.98896908984125e-06"
"1","     T1C018"
"1","
5"
"1"," Bacteroides cellulosilyticus 246787"
"1"," 5.94438208190466e-06"
"1","     T1C018"
"1","
6"
"1","            Bacteroides dorei 357276"
"1"," 5.31160969302006e-06"
"1","     T1C018"
"1","
"
"0","### Spread"
"0","bp_bcw_norm_abund_sal_t1_wide <- dcast(bp_bcw_norm_abund_sal_t1, Species2 ~ Patient_ID, value.var=""norm_rel_abund"")"
"0","?dcast()"
"0","head(bp_bcw_norm_abund_sal_t1_wide)"
"1"," "
"1","                                               Species2"
"1"," T1C018"
"1"," T1C020"
"1"," T1C021"
"1"," T1C022"
"1"," T1C023"
"1"," T1C027"
"1"," T1C029"
"1","
1"
"1","               Ab18virus Pseudomonas virus Ab18 1982096"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","
2"
"1","             Ab18virus Pseudomonas virus PaMx11 1982098"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","
3"
"1","               Acadianvirus Gordonia phage Eyre 1887646"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","
4"
"1","             Acadianvirus Gordonia phage Ghobes 1887647"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","
5"
"1","               Acadianvirus Gordonia phage GTE6 1647474"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","
6"
"1"," Acadianvirus Microbacterium phage vB_MoxS-ISF9 1458670"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","
"
"1"," "
"1"," T1C030"
"1"," T1C031"
"1"," T1C032"
"1"," T1C033"
"1"," T1C034"
"1"," T1C036"
"1"," T1C037"
"1"," T1C044"
"1"," T1C046"
"1"," T1C047"
"1"," T1C048"
"1"," T1C049"
"1"," T1C050"
"1"," T1C051"
"1"," T1C053"
"1","
1"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","
2"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","
3"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","
4"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","
5"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","
6"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","
"
"1"," "
"1"," T1C054"
"1"," T1C056"
"1"," T1C057"
"1"," T1C058"
"1"," T1C059"
"1"," T1C060"
"1"," T1C061"
"1"," T1C062"
"1"," T1C063"
"1"," T1C064"
"1"," T1C069"
"1"," T1C070"
"1"," T1C071"
"1"," T1C072"
"1"," T1C073"
"1","
1"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","
2"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","
3"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","
4"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","
5"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","
6"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","      0"
"1","
"
"1"," "
"1"," T1C076"
"1"," T1C077"
"1"," T1C081"
"1","
1"
"1","      0"
"1","      0"
"1","      0"
"1","
2"
"1","      0"
"1","      0"
"1","      0"
"1","
3"
"1","      0"
"1","      0"
"1","      0"
"1","
4"
"1","      0"
"1","      0"
"1","      0"
"1","
5"
"1","      0"
"1","      0"
"1","      0"
"1","
6"
"1","      0"
"1","      0"
"1","      0"
"1","
"
"0","## Fecal"
"0","unique(bp_bcw_norm_abund_narrow_fecal_df$Patient_ID)"
"1"," [1]"
"1"," T1C018"
"1"," T1C040"
"1"," T1C047"
"1"," T1C048"
"1"," T1C050"
"1"," T1C054"
"1"," T1C056"
"1"," T1C057"
"1"," T1C059"
"1"," T1C063"
"1"," T1C020"
"1"," T1C021"
"1"," T1C029"
"1"," T1C031"
"1"," T1C037"
"1","
"
"1","[16]"
"1"," T1C044"
"1"," T1C060"
"1"," T1C062"
"1"," T1C073"
"1"," T1C022"
"1"," T1C027"
"1"," T1C032"
"1"," T1C034"
"1"," T1C036"
"1"," T1C064"
"1"," T1C070"
"1"," T1C081"
"1"," T1C023"
"1"," T1C030"
"1"," T1C033"
"1","
"
"1","[31]"
"1"," T1C046"
"1"," T1C051"
"1"," T1C058"
"1"," T1C061"
"1"," T1C071"
"1"," T1C072"
"1","
"
"1","41 "
"1","Levels: "
"1","T1C018 T1C020 T1C021 T1C022 T1C023 T1C027 T1C029 T1C030 T1C031 T1C032 T1C033 T1C034 ... T1C081"
"1","
"
"0","unique(bp_bcw_norm_abund_narrow_saliva_df$Patient_ID)"
"1"," [1]"
"1"," T1C018"
"1"," T1C047"
"1"," T1C048"
"1"," T1C050"
"1"," T1C054"
"1"," T1C056"
"1"," T1C057"
"1"," T1C059"
"1"," T1C063"
"1"," T1C020"
"1"," T1C021"
"1"," T1C029"
"1"," T1C031"
"1"," T1C037"
"1"," T1C044"
"1","
"
"1","[16]"
"1"," T1C060"
"1"," T1C062"
"1"," T1C073"
"1"," T1C077"
"1"," T1C022"
"1"," T1C027"
"1"," T1C032"
"1"," T1C034"
"1"," T1C036"
"1"," T1C049"
"1"," T1C064"
"1"," T1C070"
"1"," T1C076"
"1"," T1C081"
"1"," T1C023"
"1","
"
"1","[31]"
"1"," T1C030"
"1"," T1C033"
"1"," T1C046"
"1"," T1C051"
"1"," T1C053"
"1"," T1C058"
"1"," T1C061"
"1"," T1C069"
"1"," T1C071"
"1"," T1C072"
"1","
"
"1","41 "
"1","Levels: "
"1","T1C018 T1C020 T1C021 T1C022 T1C023 T1C027 T1C029 T1C030 T1C031 T1C032 T1C033 T1C034 ... T1C081"
"1","
"
"0","# Compute difference between matrices"
"0","head(bp_bcw_norm_abund_narrow_saliva_df)"
"1"," "
"1","                            Species2"
"1"," Sample"
"1","       norm_rel_abund"
"1"," Timepoint"
"1"," Patient_ID"
"1"," Sample_Type"
"1","
1"
"1","            Bacteroides vulgatus 821"
"1","  ST079"
"1"," 2.23288513267209e-05"
"1","   Initial"
"1","     T1C018"
"1","      Saliva"
"1","
2"
"1","       Bacteroides helcogenes 290053"
"1","  ST079"
"1"," 2.18095872108589e-07"
"1","   Initial"
"1","     T1C018"
"1","      Saliva"
"1","
3"
"1","            Bacteroides ovatus 28116"
"1","  ST079"
"1"," 6.91543226871412e-07"
"1","   Initial"
"1","     T1C018"
"1","      Saliva"
"1","
4"
"1","            Bacteroides fragilis 817"
"1","  ST079"
"1"," 7.98896908984125e-06"
"1","   Initial"
"1","     T1C018"
"1","      Saliva"
"1","
5"
"1"," Bacteroides cellulosilyticus 246787"
"1","  ST079"
"1"," 5.94438208190466e-06"
"1","   Initial"
"1","     T1C018"
"1","      Saliva"
"1","
6"
"1","            Bacteroides dorei 357276"
"1","  ST079"
"1"," 5.31160969302006e-06"
"1","   Initial"
"1","     T1C018"
"1","      Saliva"
"1","
"
